cscope 15 $HOME/step3 -q 0000001169 0000047410
	@dev-args.h

1 #iâdeà
DEV_ARGS


2 
	#DEV_ARGS


	)

4 
	~<lšux/š™.h
>

5 
	~<lšux/moduË.h
>

6 
	~<lšux/fs.h
>

7 
	~<lšux/k”Ãl.h
>

8 
	~<lšux/¦ab.h
>

9 
	~<lšux/”ºo.h
>

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/kdev_t.h
>

12 
	~<lšux/blkdev.h
>

13 
	~<lšux/bio.h
>

14 
	~<lšux/g’hd.h
>

15 
	~<lšux/hd»g.h
>

16 
	~"xlg_as£¹.h
"

17 
	~<lšux/¥šlock.h
>

19 
	#CACHE_VOL
 (100*1024*1024è

	)

20 
	#PH_VOL
 (20*
CACHE_VOL
è

	)

21 
	#CBLOCK_SIZE
 (4096è

	)

22 
	#NBLOCKS
 (
CACHE_VOL
/
CBLOCK_SIZE
è

	)

23 
	#HARDSECT_SIZE
 (512è

	)

24 
	#NSECTORS
 (
PH_VOL
/
HARDSECT_SIZE
è

	)

25 
	#PHD_NAME
 "dev/sdb"

	)

	@module.mod.c

1 
	~<lšux/moduË.h
>

2 
	~<lšux/v”magic.h
>

3 
	~<lšux/compž”.h
>

5 
MODULE_INFO
(
v”magic
, 
VERMAGIC_STRING
);

7 
moduË
 
__this_moduË


8 
__©Œibu‹__
((
£ùiÚ
(".gnu.linkonce.this_module"))) = {

9 .
Çme
 = 
KBUILD_MODNAME
,

10 .
	gš™
 = 
š™_moduË
,

11 #ifdeà
CONFIG_MODULE_UNLOAD


12 .
	gex™
 = 
þ—nup_moduË
,

14 .
	g¬ch
 = 
MODULE_ARCH_INIT
,

17 cÚ¡ 
modv”siÚ_šfo
 
	g____v”siÚs
[]

18 
__u£d


19 
__©Œibu‹__
((
£ùiÚ
("__versions"))) = {

68 cÚ¡ 
	g__moduË_d•’ds
[]

69 
__u£d


70 
__©Œibu‹__
((
£ùiÚ
(".modinfo"))) =

74 
MODULE_INFO
(
¤cv”siÚ
, "19D6E7019286352BDABEAA5");

	@pp_narg.h

1 #iâdeà
MICRO_PP_NARG_H


2 
	#MICRO_PP_NARG_H


	)

7 
	#PP_NARG
(...è
	`PP_NARG_
(0, ##
__VA_ARGS__
,
	`PP_RSEQ_N
())

	)

8 
	#PP_NARG_
(...è
	`PP_ARG_N
(
__VA_ARGS__
)

	)

9 
	#PP_ARG_N
(
_0
,\

10 
_1
, 
_2
, 
_3
, 
_4
, 
_5
, 
_6
, 
_7
, 
_8
, 
_9
,
_10
, \

11 
_11
,
_12
,
_13
,
_14
,
_15
,
_16
,
_17
,
_18
,
_19
,
_20
, \

12 
_21
,
_22
,
_23
,
_24
,
_25
,
_26
,
_27
,
_28
,
_29
,
_30
, \

13 
_31
,
_32
,
_33
,
_34
,
_35
,
_36
,
_37
,
_38
,
_39
,
_40
, \

14 
_41
,
_42
,
_43
,
_44
,
_45
,
_46
,
_47
,
_48
,
_49
,
_50
, \

15 
_51
,
_52
,
_53
,
_54
,
_55
,
_56
,
_57
,
_58
,
_59
,
_60
, \

16 
_61
,
_62
,
_63
,
N
,...è
	)
N

17 
	#PP_RSEQ_N
() \

24 9,8,7,6,5,4,3,2,1,0

	)

29 
	#PP_SHORT_NARG
(...è
	`PP_SHORT_NARG_
(0, ##
__VA_ARGS__
,
	`PP_SHORT_RSEQ_N
())

	)

30 
	#PP_SHORT_NARG_
(...è
	`PP_SHORT_ARG_N
(
__VA_ARGS__
)

	)

31 
	#PP_SHORT_ARG_N
(
_0
, 
_1
, 
_2
, 
_3
, 
_4
, 
_5
, 
_6
, 
_7
, 
_8
, 
_9
,
_10
, \

32 
_11
,
_12
,
_13
,
_14
,
_15
,
_16
, 
N
,...è
	)
N

33 
	#PP_SHORT_RSEQ_N
(è16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0

	)

35 
	#FOR_EACH_0
(...)

	)

36 
	#FOR_EACH_1
(
wh©
, 
x
è
	`wh©
(x)

	)

37 
	#FOR_EACH_2
(
wh©
, 
x
, ...)\

38 
	`wh©
(
x
);\

39 
	`FOR_EACH_1
(
wh©
, 
__VA_ARGS__
);

	)

40 
	#FOR_EACH_3
(
wh©
, 
x
, ...)\

41 
	`wh©
(
x
);\

42 
	`FOR_EACH_2
(
wh©
, 
__VA_ARGS__
);

	)

43 
	#FOR_EACH_4
(
wh©
, 
x
, ...)\

44 
	`wh©
(
x
);\

45 
	`FOR_EACH_3
(
wh©
, 
__VA_ARGS__
);

	)

46 
	#FOR_EACH_5
(
wh©
, 
x
, ...)\

47 
	`wh©
(
x
);\

48 
	`FOR_EACH_4
(
wh©
, 
__VA_ARGS__
);

	)

49 
	#FOR_EACH_6
(
wh©
, 
x
, ...)\

50 
	`wh©
(
x
);\

51 
	`FOR_EACH_5
(
wh©
, 
__VA_ARGS__
);

	)

52 
	#FOR_EACH_7
(
wh©
, 
x
, ...)\

53 
	`wh©
(
x
);\

54 
	`FOR_EACH_6
(
wh©
, 
__VA_ARGS__
);

	)

55 
	#FOR_EACH_8
(
wh©
, 
x
, ...)\

56 
	`wh©
(
x
);\

57 
	`FOR_EACH_7
(
wh©
, 
__VA_ARGS__
);

	)

58 
	#FOR_EACH_9
(
wh©
, 
x
, ...)\

59 
	`wh©
(
x
);\

60 
	`FOR_EACH_8
(
wh©
, 
__VA_ARGS__
);

	)

61 
	#FOR_EACH_10
(
wh©
, 
x
, ...)\

62 
	`wh©
(
x
);\

63 
	`FOR_EACH_9
(
wh©
, 
__VA_ARGS__
);

	)

64 
	#FOR_EACH_11
(
wh©
, 
x
, ...)\

65 
	`wh©
(
x
);\

66 
	`FOR_EACH_10
(
wh©
, 
__VA_ARGS__
);

	)

67 
	#FOR_EACH_12
(
wh©
, 
x
, ...)\

68 
	`wh©
(
x
);\

69 
	`FOR_EACH_11
(
wh©
, 
__VA_ARGS__
);

	)

70 
	#FOR_EACH_13
(
wh©
, 
x
, ...)\

71 
	`wh©
(
x
);\

72 
	`FOR_EACH_12
(
wh©
, 
__VA_ARGS__
);

	)

73 
	#FOR_EACH_14
(
wh©
, 
x
, ...)\

74 
	`wh©
(
x
);\

75 
	`FOR_EACH_13
(
wh©
, 
__VA_ARGS__
);

	)

76 
	#FOR_EACH_15
(
wh©
, 
x
, ...)\

77 
	`wh©
(
x
);\

78 
	`FOR_EACH_14
(
wh©
, 
__VA_ARGS__
);

	)

79 
	#CONCATENATE
(
¬g1
, 
¬g2
è¬g1##
	)
arg2

80 
	#FOR_EACH_
(
N
, 
wh©
, ...è{
	`CONCATENATE
(
FOR_EACH_
, N)(wh©, 
__VA_ARGS__
)}

	)

81 
	#FOR_EACH
(
wh©
, ...è
	`FOR_EACH_
(
	`PP_SHORT_NARG
(
__VA_ARGS__
), wh©, __VA_ARGS__)

	)

	@test.c

1 
	~<lšux/k”Ãl.h
>

2 
	~<lšux/fs.h
>

6 
	$maš
()

8 
	`´štk
(
KERN_ALERT
 "CCAAC\n");

10 
	}
}

	@xcache-dev.c

8 
	~"xlg-dev.h
"

9 
	~"xÿche-dev.h
"

10 
	~<lšux/gå.h
>

11 
	~<lšux/wÜkqueue.h
>

13 
xlg_dev
 *
dev
;

22 
ÿche_block
 *
	$g‘_ÿche_block
(
ä“_zÚe
 *
fz
)

24 
ÿche_block
 *
cb
 = 
NULL
;

25 
æag
 = 0;

26 
li¡_h—d
 *
’Œy
 = 
fz
->
ä“_blocks
.
Ãxt
;

27 ià(!
’Œy
)

28  
NULL
;

29 
	`¥š_lock_œq§ve
(&
fz
->
lock
, 
æag
);

30 
	`li¡_d–_š™
(
’Œy
);

31 
	`©omic_dec
(&
fz
->
size
);

32 
	`¥š_uÆock_œq»¡Üe
(&
fz
->
lock
, 
æag
);

33 
cb
 = 
	`li¡_’Œy
(
’Œy
, 
ÿche_block
, 
block_li¡
);

34  
cb
;

35 
	}
}

46 
šlše
 
	$š£¹_block_to_¿dix_Œ“
(
ÿche_block
 *
cb
, 
¿dix_Œ“_roÙ
 *
rdŒ“
,

47 
£ùÜ_t
 
£ùÜ
)

49 
»t
 = 0;

50 
	`¿dix_Œ“_´–ßd
(
GFP_ATOMIC
);

51 
»t
 = 
	`¿dix_Œ“_š£¹
(
rdŒ“
, 
£ùÜ
, 
cb
);

52 
	`¿dix_Œ“_´–ßd_’d
();

53  
»t
;

54 
	}
}

59 
	$ä“_blocks_add
(
ÿche_block
 *
blk
, 
ä“_zÚe
 *
fz
)

61 
æag
;

63 
	`¥š_lock_œq§ve
(&
fz
->
lock
, 
æag
);

64 
	`li¡_add_ž
(&
blk
->
block_li¡
, &
fz
->
ä“_blocks
);

65 
	`©omic_šc
(&
fz
->
size
);

66 
	`wake_up
(&
dev
->
ÿche
.
wa™q
);

67 
	`¥š_uÆock_œq»¡Üe
(&
fz
->
lock
, 
æag
);

68 
	}
}

76 
	$ÿche_blocks_add
(
ÿche_block
 *
blk
, 
ÿche_zÚe
 *
cz
)

82 
	`li¡_move
(&
blk
->
block_li¡
, &
cz
->
ÿche_blocks
);

83 
	}
}

97 
	$fšd_ÿche_block
(
£ùÜ_t
 
£ùÜ
, 
ÿche_block
 **
cb
)

99 
»t
 = 0;

100 
æag
 = 0;

101 
”r
 = 0;

102 
xÿche
 *
ÿche
 = &
dev
->cache;

103 
ÿche_zÚe
 *
cz
 = &
ÿche
->cache_zone;

104 
ä“_zÚe
 *
fz
 = &
ÿche
->free_zone;

110 
»Œy
:

111 
	`wa™_ev’t
(
ÿche
->
wa™q
, (
	`©omic_»ad
(&
fz
->
size
)) > 0);

112 
	`¥š_lock_œq§ve
(&
cz
->
lock
, 
æag
);

113 *
cb
 = 
	`¿dix_Œ“_lookup
(&
cz
->
rdŒ“
, 
£ùÜ
);

114 ià(!*
cb
) {

115 *
cb
 = 
	`g‘_ÿche_block
(
fz
);

116 ià(!*
cb
) {

117 
	`¥š_uÆock_œq»¡Üe
(&
cz
->
lock
, 
æag
);

118 
»Œy
;

120 (*
cb
)->
£ùÜ
 = sector;

121 
”r
 = 
	`š£¹_block_to_¿dix_Œ“
(*
cb
, &
cz
->
rdŒ“
, 
£ùÜ
);

122 ià(
”r
) {

123 
	`ä“_blocks_add
(*
cb
, 
fz
);

124 *
cb
 = 
NULL
;

125 
uÆock
;

127 
»t
 = 1;

129 
	`©omic_šc
(&(*
cb
)->
»f_út
);

130 
	`ÿche_blocks_add
(*
cb
, 
cz
);

131 
uÆock
:

132 
	`¥š_uÆock_œq»¡Üe
(&
cz
->
lock
, 
æag
);

133  
»t
;

134 
	}
}

143 
	$ÿche_block_xãr
(
bio_vec
 *
bv
, 
ÿche_block


144 *
cb
, 
dœ
)

146 *
bufãr
 = 
	`·ge_add»ss
(
bv
->
bv_·ge
);

147 *
ÿche
 = 
	`·ge_add»ss
(
cb
->
·ge
);

148 ià(
dœ
 =ð
READ
) {

149 
	`memýy
(
bufãr
+
bv
->
bv_off£t
, 
ÿche
+bv->bv_offset,

150 
bv
->
bv_Ën
);

153 
	`memýy
(
ÿche
+
bv
->
bv_off£t
, 
bufãr
+bv->bv_offset,

154 
bv
->
bv_Ën
);

155 
	`£t_b™
(
DIRTY_BIT
, &
cb
->
æag
);

157 
	}
}

162 
	$wa™_scheduË
(*
d©a
)

164 if(
	`sigÇl_³ndšg
(
cu¼’t
))

165  -
ERESTARTSYS
;

166 
	`scheduË
();

168 
	}
}

178 
	$xÿche_xãr
(
bio_vec
 *
bv
, 
£ùÜ_t
 
£ùÜ
, 
dœ
)

180 
ÿche_block
 *
cb
 = 
NULL
;

181 
»t
 = 0;

183 
»t
 = 
	`fšd_ÿche_block
(
£ùÜ
, &
cb
);

184 ià(!
cb
)

185 
çžed
;

187 
	`‹¡_ªd_£t_b™
(
LOCK_BIT
, &
cb
->
æag
) ) {

188 
	`wa™_ev’t
(
cb
->
wa™q
, !
	`‹¡_b™
(
LOCK_BIT
, &cb->
æag
));

195 ià(
»t
) {

196 ià(
dœ
 =ð
READ
 || 
bv
->
bv_Ën
 < 
CBLOCK_SIZE
)

197 
	`xph_bio_»ad_block
(
cb
);

203 
	`wa™_Ú_b™
(&
cb
->
æag
, 
WRITING_BACK_BIT
, 
wa™_scheduË
, 
TASK_INTERRUPTIBLE
);

205 
	`ÿche_block_xãr
(
bv
, 
cb
, 
dœ
);

206 
	`©omic_dec
(&
cb
->
»f_út
);

207 
	`þ—r_b™
(
LOCK_BIT
, &
cb
->
æag
);

208 
	`wake_up
(&
cb
->
wa™q
);

210 
	`scheduË_wÜk
(&
dev
->
ÿche
.
wÜk
);

212 
çžed
:

213  -
ENOMEM
;

214 
	}
}

223 
šlše
 
	$ÿche_Ãed_æush
(
xÿche
 *
ÿche
)

225 
size
;

226 
	`DOOR
(
ÿche
);

227 
size
 = 
	`©omic_»ad
(&
ÿche
->
ä“_zÚe
.size);

228 ià(!
size
)

231 
	}
}

241 
ÿche_block
 *
	$g‘_cÞde¡_ÿche_block
(
xÿche
 *
ÿche
) {

242 
ÿche_block
 *
cb
 = 
NULL
;

243 
ÿche_block
 *
Ãxt
;

244 
ÿche_zÚe
 *
cz
;

245 
æag
 = 0;

247 
	`DOOR
(
ÿche
);

248 
cz
 = &
ÿche
->
ÿche_zÚe
;

249 
	`¥š_lock_œq§ve
(&
cz
->
lock
, 
æag
);

250 
	`li¡_fÜ_—ch_’Œy_§ã_»v”£
(
cb
, 
Ãxt
, &
cz
->
ÿche_blocks
, 
block_li¡
) {

251 ià(
	`©omic_»ad
(&
cb
->
»f_út
) > 0)

253 ià(!
	`‹¡_ªd_£t_b™
(
WRITING_BACK_BIT
, &
cb
->
æag
))

256 
	`¥š_uÆock_œq»¡Üe
(&
cz
->
lock
, 
æag
);

257  
cb
;

258 
	}
}

265 
	$»cyþe_ÿche_block
(
ÿche_block
 *
cÞbk
)

267 
ÿche_zÚe
 *
cz
 = &
dev
->
ÿche
.cache_zone;

268 
æag
;

270 
	`¥š_lock_œq§ve
(&
cz
->
lock
, 
æag
);

271 ià(!
	`©omic_»ad
(&
cÞbk
->
»f_út
)) {

272 
ÿche_block
 *
cb
 = 
NULL
;

273 
cb
 = 
	`¿dix_Œ“_d–‘e
(&
cz
->
rdŒ“
, 
cÞbk
->
£ùÜ
);

274 
	`li¡_d–_š™
(&
cÞbk
->
block_li¡
);

275 
	`¥š_uÆock_œq»¡Üe
(&
cz
->
lock
, 
æag
);

276 
	`ä“_blocks_add
(
cÞbk
, &
dev
->
ÿche
.
ä“_zÚe
);

279 
	`¥š_uÆock_œq»¡Üe
(&
cz
->
lock
, 
æag
);

281 
	`þ—r_b™
(
WRITING_BACK_BIT
, &
cÞbk
->
æag
);

282 
	`wake_up_b™
(&
cÞbk
->
æag
, 
WRITING_BACK_BIT
);

283 
	}
}

290 
	$æush_ÿche_block
(
ÿche_block
 *
cÞbk
)

292 ià(!
cÞbk
)

294 ià(
	`‹¡_b™
(
DIRTY_BIT
, &
cÞbk
->
æag
))

295 
	`xph_bio_wr™e_block
(
cÞbk
);

297 
	`»cyþe_ÿche_block
(
cÞbk
);

298 
	}
}

303 
	$æush_cÞd_ÿche_block
(
wÜk_¡ruù
 *
wÜk
)

305 
xÿche
 *
ÿche
 = &
dev
->cache;

306 ià(
	`ÿche_Ãed_æush
(
ÿche
)) {

307 
ÿche_block
 *
cÞbk
 = 
	`g‘_cÞde¡_ÿche_block
(
ÿche
);

308 
	`æush_ÿche_block
(
cÞbk
);

310 
	}
}

317 
ÿche_block
 *
	$Ãw_ÿche_block
()

320 
ÿche_block
 *
cb
 = 
NULL
;

321 
cb
 = 
	`km®loc
((
ÿche_block
), 
GFP_KERNEL
);

322 ià(!
cb
)

323 
çž_to_®loc_block_¡ruùu»
;

324 
cb
->
·ge
 = 
	`®loc_·ge
(
GFP_KERNEL
);

325 ià(!
cb
->
·ge
)

326 
çž_to_®loc_block_·ge
;

327 
	`INIT_LIST_HEAD
(&
cb
->
block_li¡
);

328 
	`©omic_£t
(&
cb
->
»f_út
, 0);

329 
	`š™_wa™queue_h—d
(&
cb
->
wa™q
);

330  
cb
;

331 
çž_to_®loc_block_·ge
:

332 
	`kä“
(
cb
);

333 
cb
 = 
NULL
;

334 
çž_to_®loc_block_¡ruùu»
:

335  
cb
;

336 
	}
}

342 
	$ä“_®l_ÿche_blocks
(
li¡_h—d
 *
ä“_blocks
)

344 
ÿche_block
 *
cur
;

345 
ÿche_block
 *
Ãxt
;

347 
	`DOOR
(
ä“_blocks
);

348 
	`li¡_fÜ_—ch_’Œy_§ã
(
cur
, 
Ãxt
, 
ä“_blocks
, 
block_li¡
) {

349 
	`li¡_d–
(&
cur
->
block_li¡
);

350 
	`__ä“_·ge
(
cur
->
·ge
);

351 
	`kä“
(
cur
);

354 
	}
}

361 
	$xÿche_š™
()

363 
xÿche
 *
ÿche
 = &
dev
->cache;

364 
ÿche_zÚe
 *
cz
 = &
ÿche
->cache_zone;

365 
ä“_zÚe
 *
fz
 = &
ÿche
->free_zone;

366 
i
 = 0;

367 
ÿche_block
 *
cb
;

370 
	`INIT_LIST_HEAD
(&
cz
->
ÿche_blocks
);

371 
	`¥š_lock_š™
(&
cz
->
lock
);

372 
	`INIT_RADIX_TREE
(&
cz
->
rdŒ“
, 
GFP_ATOMIC
);

375 
	`INIT_LIST_HEAD
(&
fz
->
ä“_blocks
);

376 
	`¥š_lock_š™
(&
fz
->
lock
);

377 
	`©omic_£t
(&
fz
->
size
, 0);

380 
	`INIT_WORK
(&
ÿche
->
wÜk
, 
æush_cÞd_ÿche_block
);

381 
	`š™_wa™queue_h—d
(&
ÿche
->
wa™q
);

384 
i
 = 0; i < 
NBLOCKS
; i++) {

385 
cb
 = 
	`Ãw_ÿche_block
();

386 ià(!
cb
)

387 
Ãw_ÿche_block_çžed
;

388 
	`©omic_£t
(&
cb
->
»f_út
, 0);

389 
cb
->
æag
 = 0;

390 
	`li¡_add
(&
cb
->
block_li¡
, &
fz
->
ä“_blocks
);

391 
	`©omic_šc
(&
fz
->
size
);

394 
Ãw_ÿche_block_çžed
:

395 
	`ä“_®l_ÿche_blocks
(&
fz
->
ä“_blocks
);

396  -
ENOMEM
;

397 
	}
}

404 
	$æush_®l_ÿche_blocks
()

406 
ÿche_zÚe
 *
cz
 = &
dev
->
ÿche
.cache_zone;

407 
ÿche_block
 *
cb
;

408 
ÿche_block
 *
tmp
;

410 
	`li¡_fÜ_—ch_’Œy_§ã
(
cb
, 
tmp
, &
cz
->
ÿche_blocks
, 
block_li¡
) {

411 
	`©omic_»ad
(&
cb
->
»f_út
è|| 
	`‹¡_ªd_£t_b™
(
WRITING_BACK_BIT
, &cb->
æag
))

412 
	`wa™_ev’t
(
cb
->
wa™q
, 
	`©omic_»ad
(&cb->
»f_út
) == 0);

413 
	`æush_ÿche_block
(
cb
);

415 
	}
}

421 
	$xÿche_de¡roy
()

423 
	`æush_®l_ÿche_blocks
();

424 
	`ä“_®l_ÿche_blocks
(&
dev
->
ÿche
.
ä“_zÚe
.
ä“_blocks
);

426 
	}
}

	@xcache-dev.h

1 #iâdeà
XCACHE_DEV


2 
	#XCACHE_DEV


	)

4 
	~"dev-¬gs.h
"

5 
	~<lšux/¿dix-Œ“.h
>

6 
	~<lšux/wa™.h
>

7 
	~<lšux/li¡.h
>

9 
	#DIRTY_BIT
 0

	)

10 
	#WRITING_BACK_BIT
 1

	)

11 
	#LOCK_BIT
 2

	)

13 
	sÿche_block
 {

14 
li¡_h—d
 
	mblock_li¡
;

15 
	m£ùÜ
;

16 
·ge
 *
	m·ge
;

17 
©omic_t
 
	m»f_út
;

18 
wa™_queue_h—d_t
 
	mwa™q
;

19 
	mæag
;

22 
	sÿche_zÚe
 {

23 
li¡_h—d
 
	mÿche_blocks
;

24 
¿dix_Œ“_roÙ
 
	mrdŒ“
;

25 
¥šlock_t
 
	mlock
;

28 
	sä“_zÚe
 {

29 
li¡_h—d
 
	mä“_blocks
;

30 
©omic_t
 
	msize
;

31 
¥šlock_t
 
	mlock
;

34 
	sxÿche
 {

35 
ÿche_zÚe
 
	mÿche_zÚe
;

36 
ä“_zÚe
 
	mä“_zÚe
;

37 
wÜk_¡ruù
 
	mwÜk
;

38 
wa™_queue_h—d_t
 
	mwa™q
;

41 
»cyþe_ÿche_block
(
ÿche_block
 *
blk
);

43 
xÿche_xãr
(
bio_vec
 *
bv
, 
£ùÜ_t
 
£ùÜ
, 
dœ
);

45 
xÿche_š™
();

47 
xÿche_de¡roy
();

	@xlg-dev.c

8 
	~"xlg-dev.h
"

10 
MODULE_LICENSE
("Dual BSD/GPL");

12 
	gxlg_majÜ
 = 0;

13 
	gh¬d£ù_size
 = 
HARDSECT_SIZE
;

14 
	gxlg_fœ¡_mšÜ
 = 0;

15 cÚ¡ *
	gxd_Çme
 = "xlg_dev";

16 
	gn£ùÜs
 = 
NSECTORS
;

18 
	#XLG_MINORS
 1

	)

19 
	#KERNEL_SECTOR_SIZE
 512

	)

21 
»que¡_queue
 
	t»que¡_queue_t
;

23 
xlg_dev
 *
	gdev
;

28 
	$xlg_Ý’
(
šode
 *šode, 
fže
 *
fžp
)

30 
xlg_dev
 *
dev
 = 
šode
->
i_bdev
->
bd_disk
->
´iv©e_d©a
;

31 
fžp
->
´iv©e_d©a
 = 
dev
;

32 
	`¥š_lock
(&
dev
->
lock
);

33 
dev
->
u£rs
++;

34 
	`¥š_uÆock
(&
dev
->
lock
);

36 
	}
}

41 
	$xlg_»Ëa£
(
šode
 *šode, 
fže
 *
fžp
)

43 
xlg_dev
 *
dev
 = 
šode
->
i_bdev
->
bd_disk
->
´iv©e_d©a
;

44 
	`¥š_lock
(&
dev
->
lock
);

45 
dev
->
u£rs
--;

46 
	`¥š_uÆock
(&
dev
->
lock
);

48 
	}
}

53 
	$xlg_ioùl
(
šode
 *šode, 
fže
 *
fžp
,

54 
cmd
, 
¬g
)

56 
size
;

57 
hd_geom‘ry
 
geo
;

58 
xlg_dev
 *
dev
 = 
fžp
->
´iv©e_d©a
;

60 
cmd
) {

61 
HDIO_GETGEO
:

68 
size
 = 
dev
->size*(
h¬d£ù_size
/
KERNEL_SECTOR_SIZE
);

69 
geo
.
cylšd”s
 = (
size
 & ~0x3f) >> 6;

70 
geo
.
h—ds
 = 4;

71 
geo
.
£ùÜs
 = 16;

72 
geo
.
¡¬t
 = 4;

73 ià(
	`cÝy_to_u£r
((
__u£r
 *è
¬g
, &
geo
, (geo)))

74  -
EFAULT
;

77  -
ENOTTY
;

78 
	}
}

83 
block_deviû_Ý”©iÚs
 
	gxlg_Ýs
 = {

84 .
owÃr
 = 
THIS_MODULE
,

85 .
	gÝ’
 = 
xlg_Ý’
,

86 .
	g»Ëa£
 = 
xlg_»Ëa£
,

87 .
	gioùl
 = 
xlg_ioùl


94 
	$xlg_make_»que¡
(
»que¡_queue_t
 *
q
, 
bio
 *bio)

96 
»t
 = 0;

97 
bio_vec
 *
bv
 = 
NULL
;

98 
i
 = 0;

99 
£ùÜ_t
 
£ùÜ
 = 
bio
->
bi_£ùÜ
 & ~7;

100 
	`bio_fÜ_—ch_£gm’t
(
bv
, 
bio
, 
i
) {

101 
»t
 = 
	`xÿche_xãr
(
bv
, 
£ùÜ
, 
	`bio_d©a_dœ
(
bio
));

102 ià(
»t
)

104 
£ùÜ
 += 8;

106 
	`bio_’dio
(
bio
, 
»t
);

108 
	}
}

113 
	$£tup_deviû
()

115 
»t
;

120 
	`mem£t
 (
dev
, 0,  (
xlg_dev
));

121 
dev
->
size
 = 
n£ùÜs
;

122 
	`¥š_lock_š™
(&
dev
->
lock
);

127 
dev
->
queue
 = 
	`blk_®loc_queue
(
GFP_KERNEL
);

128 ià(
dev
->
queue
 =ð
NULL
) {

129 
»t
 = -
ENOMEM
;

130 
out_vä“
;

132 
	`blk_queue_make_»que¡
(
dev
->
queue
, 
xlg_make_»que¡
);

133 
	`blk_queue_logiÿl_block_size
(
dev
->
queue
, 
h¬d£ù_size
);

138 
dev
->
gd
 = 
	`®loc_disk
(
XLG_MINORS
);

139 ià(! 
dev
->
gd
) {

140 
	`´štk
 (
KERN_NOTICE
 "alloc_disk failure\n");

141 
»t
 = -
ENOMEM
;

142 
out_vä“
;

144 
dev
->
gd
->
majÜ
 = 
xlg_majÜ
;

145 
dev
->
gd
->
fœ¡_mšÜ
 = 
xlg_fœ¡_mšÜ
;

146 
dev
->
gd
->
fÝs
 = &
xlg_Ýs
;

147 
dev
->
gd
->
queue
 = dev->queue;

148 
dev
->
gd
->
´iv©e_d©a
 = dev;

149 
	`¢´štf
 (
dev
->
gd
->
disk_Çme
, 32, 
xd_Çme
);

150 
	`£t_ÿ·c™y
(
dev
->
gd
, 
n£ùÜs
*(
h¬d£ù_size
/
KERNEL_SECTOR_SIZE
));

152 
out_vä“
:

153  
»t
;

154 
	}
}

159 
__š™
 
	$xlg_š™
()

161 
»t
;

165 
xlg_majÜ
 = 
	`»gi¡”_blkdev
(xlg_majÜ, 
xd_Çme
);

166 ià(
xlg_majÜ
 <= 0) {

167 
	`´štk
(
KERN_WARNING
 "xlg: unableo get major‚umber\n");

168  -
EBUSY
;

173 
	`´štk
(
KERN_ALERT
 "ALLOCATE MEMORY");

174 
dev
 = 
	`km®loc
((
xlg_dev
), 
GFP_KERNEL
);

175 
	`DOOR
(
dev
);

176 
	`´štk
(
KERN_ALERT
 "ALLOCATED");

177 ià(
dev
 =ð
NULL
) {

178 
xlg_dev_š™_çžed
;

180 
»t
 = 
	`£tup_deviû
();

181 
	`´štk
(
KERN_ALERT
 "setup_device()");

182 ià(
»t
)

183 
xlg_dev_š™_çžed
;

184 
	`´štk
(
KERN_ALERT
 "setup ....");

185 ià(
	`IS_ERR
(
	`xph_š™
())) {

186 
»t
 = -
ENODEV
;

187 
xlg_dev_š™_çžed
;

189 
	`´štk
(
KERN_ALERT
 "xcache_init()");

190 
»t
 = 
	`xÿche_š™
();

191 
	`´štk
(
KERN_ALERT
 "AFTER xcache_init()");

192 ià(
»t
)

193 
xÿche_dev_š™_çžed
;

194 
	`add_disk
(
dev
->
gd
);

197 
xÿche_dev_š™_çžed
:

198 
	`xÿche_de¡roy
();

199 
xlg_dev_š™_çžed
:

200 
	`uÄegi¡”_blkdev
(
xlg_majÜ
, 
xd_Çme
);

201  -
ENOMEM
;

202 
	}
}

207 
__ex™
 
	$xlg_ex™
()

209 ià(
dev
->
gd
) {

210 
	`d–_g’disk
(
dev
->
gd
);

212 ià(
dev
->
queue
) {

213 
	`blk_put_queue
(
dev
->
queue
);

215 
	`xÿche_de¡roy
();

216 
	`xph_de¡roy
();

217 
	`uÄegi¡”_blkdev
(
xlg_majÜ
, 
xd_Çme
);

218 
	`kä“
(
dev
);

219 
	}
}

221 
moduË_š™
(
xlg_š™
);

222 
moduË_ex™
(
xlg_ex™
);

223 
MODULE_AUTHOR
("xiaowenjian");

224 
MODULE_DESCRIPTION
("The disk driver with cache");

225 
MODULE_VERSION
("0.1");

	@xlg-dev.h

1 #iâdeà
XLG_DEV


2 
	#XLG_DEV


	)

4 
	~"dev-¬gs.h
"

5 
	~"xÿche-dev.h
"

6 
	~"xph-dev.h
"

8 
	sxlg_dev
 {

9 
	msize
;

11 
	mu£rs
;

13 
¥šlock_t
 
	mlock
;

14 
»que¡_queue
 *
	mqueue
;

15 
g’disk
 *
	mgd
;

16 
xÿche
 
	mÿche
;

18 
block_deviû
 *
	mbdev
;

	@xlg_assert.h

1 #iâdeà
XLG_ASSERT_H


2 
	#XLG_ASSERT_H


	)

3 
	~"µ_Çrg.h
"

4 
	#_SAFETY_DOOR_


	)

6 #ifdeà
_SAFETY_DOOR_


7 
	#SDOOR
(
‹¡
) \

9 ià(
	`uÆik–y
(!(
‹¡
))) { \

10 
	`´štk
(
KERN_NOTICE
 "%s:%d:In function %s: Assertion (" \

12 "èçž!\n", 
	`¡¼chr
(
__FILE__
, '/') + 1, \

13 
__LINE__
, 
__FUNCTION__
); \

15 }

	)

17 
	#SDOOR
(
‹¡
)

	)

21 
	#GATE
(...è
	`FOR_EACH
(
SDOOR
, 
__VA_ARGS__
)

	)

23 #ifdeà
_SAFETY_DOOR_


24 
	#DOOR
(...è
	`GATE
(
__VA_ARGS__
)

	)

26 
	#DOOR
(...)

	)

	@xph-dev.c

8 
	~"xph-dev.h
"

10 cÚ¡ *
	gphd_Çme
 = 
PHD_NAME
;

12 
xlg_dev
 *
dev
;

17 
	$wr™e_xph_’dio
(
bio
 *bio, 
”r
)

19 
ÿche_block
 *
blk
 = 
bio
->
bi_´iv©e
;

20 
	`þ—r_b™
(
DIRTY_BIT
, &
blk
->
æag
);

21 
	`»cyþe_ÿche_block
(
blk
);

22 
	}
}

27 
bio
 *
	$xph_cÚ¡ruù_bio
(
dœ
, 
ÿche_block
 *
cb
)

29 
bio
 *bio;

30 
bio
 = 
	`bio_®loc
(
GFP_KERNEL
, 1);

31 ià(!
bio
)

32  
bio
;

33 
bio
->
bi_£ùÜ
 = 
cb
->
£ùÜ
;

34 
bio
->
bi_bdev
 = 
dev
->
bdev
;

35 
bio
->
bi_rw
 = 
dœ
;

36 
bio
->
bi_vút
 = 0;

37 
bio
->
bi_idx
 = 0;

38 
bio
->
bi_size
 = 4096;

39 
bio
->
bi_io_vec
[0].
bv_off£t
 = 0;

40 
bio
->
bi_io_vec
[0].
bv_Ën
 = 4096;

41 
bio
->
bi_io_vec
[0].
bv_·ge
 = 
cb
->
·ge
;

42 
bio
->
bi_´iv©e
 = 
cb
;

43 ià(
dœ
 =ð
WRITE
)

44 
bio
->
bi_’d_io
 = 
wr™e_xph_’dio
;

45  
bio
;

46 
	}
}

51 
	$xph_bio_xãr
(
dœ
, 
ÿche_block
 *
cb
)

53 
bio
 *bio;

54 
»t
 = 0;

56 
bio
 = 
	`xph_cÚ¡ruù_bio
(
dœ
, 
cb
);

57 ià(!
bio
) {

58 
»t
 = -
ENOMEM
;

59 
	`þ—r_b™
(
WRITING_BACK_BIT
, &
cb
->
æag
);

60  
»t
;

62 
	`subm™_bio
(
dœ
, 
bio
);

63  
»t
;

64 
	}
}

68 
block_deviû
 *
	$xph_š™
()

72 
dev
->
bdev
 = 
	`blkdev_g‘_by_·th
(
phd_Çme
, 0, 
NULL
);

73  
dev
->
bdev
;

74 
	}
}

79 
	$xph_de¡roy
()

82 
	`blkdev_put
(
dev
->
bdev
, 0);

83 
dev
->
bdev
 = 
NULL
;

84 
	}
}

	@xph-dev.h

1 #iâdeà
XPH_DEV


2 
	#XPH_DEV


	)

4 
	~"dev-¬gs.h
"

5 
	~"xlg-dev.h
"

6 
	~"xÿche-dev.h
"

8 
	#xph_bio_wr™e_block
(
cb
è
	`xph_bio_xãr
(
WRITE
, cb)

	)

9 
	#xph_bio_»ad_block
(
cb
è
	`xph_bio_xãr
(
READ
, cb)

	)

11 
xph_bio_xãr
(
dœ
, 
ÿche_block
 *
cb
);

13 
block_deviû
 *
xph_š™
();

15 
xph_de¡roy
();

	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/linux/fs.h

1 #iâdeà
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<lšux/lim™s.h
>

10 
	~<lšux/ioùl.h
>

11 
	~<lšux/blk_ty³s.h
>

12 
	~<lšux/ty³s.h
>

25 #undeà
NR_OPEN


26 
	#INR_OPEN_CUR
 1024

	)

27 
	#INR_OPEN_MAX
 4096

	)

29 
	#BLOCK_SIZE_BITS
 10

	)

30 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

32 
	#SEEK_SET
 0

	)

33 
	#SEEK_CUR
 1

	)

34 
	#SEEK_END
 2

	)

35 
	#SEEK_MAX
 
SEEK_END


	)

37 
	sf¡rim_¿nge
 {

38 
__u64
 
	m¡¬t
;

39 
__u64
 
	mËn
;

40 
__u64
 
	mmšËn
;

44 
	sfžes_¡©_¡ruù
 {

45 
	mÄ_fžes
;

46 
	mÄ_ä“_fžes
;

47 
	mmax_fžes
;

50 
	sšodes_¡©_t
 {

51 
	mÄ_šodes
;

52 
	mÄ_unu£d
;

53 
	mdummy
[5];

57 
	#NR_FILE
 8192

	)

59 
	#MAY_EXEC
 1

	)

60 
	#MAY_WRITE
 2

	)

61 
	#MAY_READ
 4

	)

62 
	#MAY_APPEND
 8

	)

63 
	#MAY_ACCESS
 16

	)

64 
	#MAY_OPEN
 32

	)

65 
	#MAY_CHDIR
 64

	)

73 
	#FMODE_READ
 ((
fmode_t
)0x1)

	)

75 
	#FMODE_WRITE
 ((
fmode_t
)0x2)

	)

77 
	#FMODE_LSEEK
 ((
fmode_t
)0x4)

	)

79 
	#FMODE_PREAD
 ((
fmode_t
)0x8)

	)

81 
	#FMODE_PWRITE
 ((
fmode_t
)0x10)

	)

83 
	#FMODE_EXEC
 ((
fmode_t
)0x20)

	)

85 
	#FMODE_NDELAY
 ((
fmode_t
)0x40)

	)

87 
	#FMODE_EXCL
 ((
fmode_t
)0x80)

	)

90 
	#FMODE_WRITE_IOCTL
 ((
fmode_t
)0x100)

	)

98 
	#FMODE_NOCMTIME
 ((
fmode_t
)0x800)

	)

101 
	#FMODE_RANDOM
 ((
fmode_t
)0x1000)

	)

104 
	#FMODE_UNSIGNED_OFFSET
 ((
fmode_t
)0x2000)

	)

107 
	#FMODE_PATH
 ((
fmode_t
)0x4000)

	)

110 
	#FMODE_NONOTIFY
 ((
fmode_t
)0x1000000)

	)

154 
	#RW_MASK
 
REQ_WRITE


	)

155 
	#RWA_MASK
 
REQ_RAHEAD


	)

157 
	#READ
 0

	)

158 
	#WRITE
 
RW_MASK


	)

159 
	#READA
 
RWA_MASK


	)

161 
	#READ_SYNC
 (
READ
 | 
REQ_SYNC
)

	)

162 
	#READ_META
 (
READ
 | 
REQ_META
)

	)

163 
	#WRITE_SYNC
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
)

	)

164 
	#WRITE_ODIRECT
 (
WRITE
 | 
REQ_SYNC
)

	)

165 
	#WRITE_META
 (
WRITE
 | 
REQ_META
)

	)

166 
	#WRITE_FLUSH
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
)

	)

167 
	#WRITE_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FUA
)

	)

168 
	#WRITE_FLUSH_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
)

	)

170 
	#SEL_IN
 1

	)

171 
	#SEL_OUT
 2

	)

172 
	#SEL_EX
 4

	)

175 
	#FS_REQUIRES_DEV
 1

	)

176 
	#FS_BINARY_MOUNTDATA
 2

	)

177 
	#FS_HAS_SUBTYPE
 4

	)

178 
	#FS_REVAL_DOT
 16384

	)

179 
	#FS_RENAME_DOES_D_MOVE
 32768

	)

186 
	#MS_RDONLY
 1

	)

187 
	#MS_NOSUID
 2

	)

188 
	#MS_NODEV
 4

	)

189 
	#MS_NOEXEC
 8

	)

190 
	#MS_SYNCHRONOUS
 16

	)

191 
	#MS_REMOUNT
 32

	)

192 
	#MS_MANDLOCK
 64

	)

193 
	#MS_DIRSYNC
 128

	)

194 
	#MS_NOATIME
 1024

	)

195 
	#MS_NODIRATIME
 2048

	)

196 
	#MS_BIND
 4096

	)

197 
	#MS_MOVE
 8192

	)

198 
	#MS_REC
 16384

	)

199 
	#MS_VERBOSE
 32768

	)

201 
	#MS_SILENT
 32768

	)

202 
	#MS_POSIXACL
 (1<<16è

	)

203 
	#MS_UNBINDABLE
 (1<<17è

	)

204 
	#MS_PRIVATE
 (1<<18è

	)

205 
	#MS_SLAVE
 (1<<19è

	)

206 
	#MS_SHARED
 (1<<20è

	)

207 
	#MS_RELATIME
 (1<<21è

	)

208 
	#MS_KERNMOUNT
 (1<<22è

	)

209 
	#MS_I_VERSION
 (1<<23è

	)

210 
	#MS_STRICTATIME
 (1<<24è

	)

211 
	#MS_NOSEC
 (1<<28)

	)

212 
	#MS_BORN
 (1<<29)

	)

213 
	#MS_ACTIVE
 (1<<30)

	)

214 
	#MS_NOUSER
 (1<<31)

	)

219 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

224 
	#MS_MGC_VAL
 0xC0ED0000

	)

225 
	#MS_MGC_MSK
 0xffff0000

	)

229 
	#S_SYNC
 1

	)

230 
	#S_NOATIME
 2

	)

231 
	#S_APPEND
 4

	)

232 
	#S_IMMUTABLE
 8

	)

233 
	#S_DEAD
 16

	)

234 
	#S_NOQUOTA
 32

	)

235 
	#S_DIRSYNC
 64

	)

236 
	#S_NOCMTIME
 128

	)

237 
	#S_SWAPFILE
 256

	)

238 
	#S_PRIVATE
 512

	)

239 
	#S_IMA
 1024

	)

240 
	#S_AUTOMOUNT
 2048

	)

241 
	#S_NOSEC
 4096

	)

256 
	#__IS_FLG
(
šode
,
æg
è((šode)->
i_sb
->
s_æags
 & (æg))

	)

258 
	#IS_RDONLY
(
šode
è((šode)->
i_sb
->
s_æags
 & 
MS_RDONLY
)

	)

259 
	#IS_SYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
) || \

260 ((
šode
)->
i_æags
 & 
S_SYNC
))

	)

261 
	#IS_DIRSYNC
(
šode
è(
	`__IS_FLG
(šode, 
MS_SYNCHRONOUS
|
MS_DIRSYNC
) || \

262 ((
šode
)->
i_æags
 & (
S_SYNC
|
S_DIRSYNC
)))

	)

263 
	#IS_MANDLOCK
(
šode
è
	`__IS_FLG
(šode, 
MS_MANDLOCK
)

	)

264 
	#IS_NOATIME
(
šode
è
	`__IS_FLG
(šode, 
MS_RDONLY
|
MS_NOATIME
)

	)

265 
	#IS_I_VERSION
(
šode
è
	`__IS_FLG
(šode, 
MS_I_VERSION
)

	)

267 
	#IS_NOQUOTA
(
šode
è((šode)->
i_æags
 & 
S_NOQUOTA
)

	)

268 
	#IS_APPEND
(
šode
è((šode)->
i_æags
 & 
S_APPEND
)

	)

269 
	#IS_IMMUTABLE
(
šode
è((šode)->
i_æags
 & 
S_IMMUTABLE
)

	)

270 
	#IS_POSIXACL
(
šode
è
	`__IS_FLG
(šode, 
MS_POSIXACL
)

	)

272 
	#IS_DEADDIR
(
šode
è((šode)->
i_æags
 & 
S_DEAD
)

	)

273 
	#IS_NOCMTIME
(
šode
è((šode)->
i_æags
 & 
S_NOCMTIME
)

	)

274 
	#IS_SWAPFILE
(
šode
è((šode)->
i_æags
 & 
S_SWAPFILE
)

	)

275 
	#IS_PRIVATE
(
šode
è((šode)->
i_æags
 & 
S_PRIVATE
)

	)

276 
	#IS_IMA
(
šode
è((šode)->
i_æags
 & 
S_IMA
)

	)

277 
	#IS_AUTOMOUNT
(
šode
è((šode)->
i_æags
 & 
S_AUTOMOUNT
)

	)

278 
	#IS_NOSEC
(
šode
è((šode)->
i_æags
 & 
S_NOSEC
)

	)

283 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

284 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

285 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

286 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

287 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

288 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

289 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

290 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

291 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

292 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

293 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

294 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

296 
	#BLKPG
 
	`_IO
(0x12,105)

	)

300 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

301 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

306 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

307 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

308 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

309 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

310 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

311 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

312 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

313 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

314 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

315 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

316 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

317 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

318 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

319 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

321 
	#BMAP_IOCTL
 1

	)

322 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

323 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

324 
	#FIFREEZE
 
	`_IOWR
('X', 119, è

	)

325 
	#FITHAW
 
	`_IOWR
('X', 120, è

	)

326 
	#FITRIM
 
	`_IOWR
('X', 121, 
f¡rim_¿nge
è

	)

328 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

329 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

330 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

331 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

332 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

333 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

334 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

335 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

336 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

341 
	#FS_SECRM_FL
 0x00000001

	)

342 
	#FS_UNRM_FL
 0x00000002

	)

343 
	#FS_COMPR_FL
 0x00000004

	)

344 
	#FS_SYNC_FL
 0x00000008

	)

345 
	#FS_IMMUTABLE_FL
 0x00000010

	)

346 
	#FS_APPEND_FL
 0x00000020

	)

347 
	#FS_NODUMP_FL
 0x00000040

	)

348 
	#FS_NOATIME_FL
 0x00000080

	)

350 
	#FS_DIRTY_FL
 0x00000100

	)

351 
	#FS_COMPRBLK_FL
 0x00000200

	)

352 
	#FS_NOCOMP_FL
 0x00000400

	)

353 
	#FS_ECOMPR_FL
 0x00000800

	)

355 
	#FS_BTREE_FL
 0x00001000

	)

356 
	#FS_INDEX_FL
 0x00001000

	)

357 
	#FS_IMAGIC_FL
 0x00002000

	)

358 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

359 
	#FS_NOTAIL_FL
 0x00008000

	)

360 
	#FS_DIRSYNC_FL
 0x00010000

	)

361 
	#FS_TOPDIR_FL
 0x00020000

	)

362 
	#FS_EXTENT_FL
 0x00080000

	)

363 
	#FS_DIRECTIO_FL
 0x00100000

	)

364 
	#FS_NOCOW_FL
 0x00800000

	)

365 
	#FS_RESERVED_FL
 0x80000000

	)

367 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

368 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

371 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

372 
	#SYNC_FILE_RANGE_WRITE
 2

	)

373 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

	@/usr/include/linux/hdreg.h

1 #iâdeà
_LINUX_HDREG_H


2 
	#_LINUX_HDREG_H


	)

4 
	~<lšux/ty³s.h
>

10 
	#HDIO_DRIVE_CMD_HDR_SIZE
 (4 * (
__u8
))

	)

11 
	#HDIO_DRIVE_HOB_HDR_SIZE
 (8 * (
__u8
))

	)

12 
	#HDIO_DRIVE_TASK_HDR_SIZE
 (8 * (
__u8
))

	)

14 
	#IDE_DRIVE_TASK_NO_DATA
 0

	)

15 
	#IDE_DRIVE_TASK_INVALID
 -1

	)

16 
	#IDE_DRIVE_TASK_SET_XFER
 1

	)

17 
	#IDE_DRIVE_TASK_IN
 2

	)

18 
	#IDE_DRIVE_TASK_OUT
 3

	)

19 
	#IDE_DRIVE_TASK_RAW_WRITE
 4

	)

24 
	#IDE_TASKFILE_STD_IN_FLAGS
 0xFE

	)

25 
	#IDE_HOB_STD_IN_FLAGS
 0x3C

	)

26 
	#IDE_TASKFILE_STD_OUT_FLAGS
 0xFE

	)

27 
	#IDE_HOB_STD_OUT_FLAGS
 0x3C

	)

29 
	tsk_iÜeg_t
;

30 
	t§_iÜeg_t
;

32 
	uide_»g_v®id_s
 {

33 
	m®l
 : 16;

35 
	md©a
 : 1;

36 
	m”rÜ_ã©u»
 : 1;

37 
	m£ùÜ
 : 1;

38 
	mn£ùÜ
 : 1;

39 
	mlcyl
 : 1;

40 
	mhcyl
 : 1;

41 
	m£Ëù
 : 1;

42 
	m¡©us_commªd
 : 1;

44 
	md©a_hob
 : 1;

45 
	m”rÜ_ã©u»_hob
 : 1;

46 
	m£ùÜ_hob
 : 1;

47 
	mn£ùÜ_hob
 : 1;

48 
	mlcyl_hob
 : 1;

49 
	mhcyl_hob
 : 1;

50 
	m£Ëù_hob
 : 1;

51 
	mcÚŒÞ_hob
 : 1;

52 } 
	mb
;

53 } 
	tide_»g_v®id_t
;

55 
	side_sk_»que¡_s
 {

56 
__u8
 
	mio_pÜts
[8];

57 
__u8
 
	mhob_pÜts
[8];

58 
ide_»g_v®id_t
 
	mout_æags
;

59 
ide_»g_v®id_t
 
	mš_æags
;

60 
	md©a_pha£
;

61 
	m»q_cmd
;

62 
	mout_size
;

63 
	mš_size
;

64 } 
	tide_sk_»que¡_t
;

66 
	side_ioùl_»que¡_s
 {

67 
ide_sk_»que¡_t
 *
	msk_»que¡
;

68 *
	mout_bufãr
;

69 *
	mš_bufãr
;

70 } 
	tide_ioùl_»que¡_t
;

72 
	shd_drive_cmd_hdr
 {

73 
__u8
 
	mcommªd
;

74 
__u8
 
	m£ùÜ_numb”
;

75 
__u8
 
	mã©u»
;

76 
__u8
 
	m£ùÜ_couÁ
;

79 
	shd_drive_sk_hdr
 {

80 
__u8
 
	md©a
;

81 
__u8
 
	mã©u»
;

82 
__u8
 
	m£ùÜ_couÁ
;

83 
__u8
 
	m£ùÜ_numb”
;

84 
__u8
 
	mlow_cylšd”
;

85 
__u8
 
	mhigh_cylšd”
;

86 
__u8
 
	mdeviû_h—d
;

87 
__u8
 
	mcommªd
;

88 } 
	tsk_¡ruù_t
;

90 
	shd_drive_hob_hdr
 {

91 
__u8
 
	md©a
;

92 
__u8
 
	mã©u»
;

93 
__u8
 
	m£ùÜ_couÁ
;

94 
__u8
 
	m£ùÜ_numb”
;

95 
__u8
 
	mlow_cylšd”
;

96 
__u8
 
	mhigh_cylšd”
;

97 
__u8
 
	mdeviû_h—d
;

98 
__u8
 
	mcÚŒÞ
;

99 } 
	thob_¡ruù_t
;

101 
	#TASKFILE_NO_DATA
 0x0000

	)

103 
	#TASKFILE_IN
 0x0001

	)

104 
	#TASKFILE_MULTI_IN
 0x0002

	)

106 
	#TASKFILE_OUT
 0x0004

	)

107 
	#TASKFILE_MULTI_OUT
 0x0008

	)

108 
	#TASKFILE_IN_OUT
 0x0010

	)

110 
	#TASKFILE_IN_DMA
 0x0020

	)

111 
	#TASKFILE_OUT_DMA
 0x0040

	)

112 
	#TASKFILE_IN_DMAQ
 0x0080

	)

113 
	#TASKFILE_OUT_DMAQ
 0x0100

	)

115 
	#TASKFILE_P_IN
 0x0200

	)

116 
	#TASKFILE_P_OUT
 0x0400

	)

117 
	#TASKFILE_P_IN_DMA
 0x0800

	)

118 
	#TASKFILE_P_OUT_DMA
 0x1000

	)

119 
	#TASKFILE_P_IN_DMAQ
 0x2000

	)

120 
	#TASKFILE_P_OUT_DMAQ
 0x4000

	)

121 
	#TASKFILE_48
 0x8000

	)

122 
	#TASKFILE_INVALID
 0x7fff

	)

125 
	#WIN_NOP
 0x00

	)

129 
	#CFA_REQ_EXT_ERROR_CODE
 0x03

	)

133 
	#WIN_SRST
 0x08

	)

134 
	#WIN_DEVICE_RESET
 0x08

	)

138 
	#WIN_RECAL
 0x10

	)

139 
	#WIN_RESTORE
 
WIN_RECAL


	)

143 
	#WIN_READ
 0x20

	)

144 
	#WIN_READ_ONCE
 0x21

	)

145 
	#WIN_READ_LONG
 0x22

	)

146 
	#WIN_READ_LONG_ONCE
 0x23

	)

147 
	#WIN_READ_EXT
 0x24

	)

148 
	#WIN_READDMA_EXT
 0x25

	)

149 
	#WIN_READDMA_QUEUED_EXT
 0x26

	)

150 
	#WIN_READ_NATIVE_MAX_EXT
 0x27

	)

154 
	#WIN_MULTREAD_EXT
 0x29

	)

158 
	#WIN_WRITE
 0x30

	)

159 
	#WIN_WRITE_ONCE
 0x31

	)

160 
	#WIN_WRITE_LONG
 0x32

	)

161 
	#WIN_WRITE_LONG_ONCE
 0x33

	)

162 
	#WIN_WRITE_EXT
 0x34

	)

163 
	#WIN_WRITEDMA_EXT
 0x35

	)

164 
	#WIN_WRITEDMA_QUEUED_EXT
 0x36

	)

165 
	#WIN_SET_MAX_EXT
 0x37

	)

166 
	#CFA_WRITE_SECT_WO_ERASE
 0x38

	)

167 
	#WIN_MULTWRITE_EXT
 0x39

	)

171 
	#WIN_WRITE_VERIFY
 0x3C

	)

175 
	#WIN_VERIFY
 0x40

	)

176 
	#WIN_VERIFY_ONCE
 0x41

	)

177 
	#WIN_VERIFY_EXT
 0x42

	)

181 
	#WIN_FORMAT
 0x50

	)

185 
	#WIN_INIT
 0x60

	)

189 
	#WIN_SEEK
 0x70

	)

191 
	#CFA_TRANSLATE_SECTOR
 0x87

	)

192 
	#WIN_DIAGNOSE
 0x90

	)

193 
	#WIN_SPECIFY
 0x91

	)

194 
	#WIN_DOWNLOAD_MICROCODE
 0x92

	)

195 
	#WIN_STANDBYNOW2
 0x94

	)

196 
	#WIN_STANDBY2
 0x96

	)

197 
	#WIN_SETIDLE2
 0x97

	)

198 
	#WIN_CHECKPOWERMODE2
 0x98

	)

199 
	#WIN_SLEEPNOW2
 0x99

	)

203 
	#WIN_PACKETCMD
 0xA0

	)

204 
	#WIN_PIDENTIFY
 0xA1

	)

205 
	#WIN_QUEUED_SERVICE
 0xA2

	)

206 
	#WIN_SMART
 0xB0

	)

207 
	#CFA_ERASE_SECTORS
 0xC0

	)

208 
	#WIN_MULTREAD
 0xC4

	)

209 
	#WIN_MULTWRITE
 0xC5

	)

210 
	#WIN_SETMULT
 0xC6

	)

211 
	#WIN_READDMA_QUEUED
 0xC7

	)

212 
	#WIN_READDMA
 0xC8

	)

213 
	#WIN_READDMA_ONCE
 0xC9

	)

214 
	#WIN_WRITEDMA
 0xCA

	)

215 
	#WIN_WRITEDMA_ONCE
 0xCB

	)

216 
	#WIN_WRITEDMA_QUEUED
 0xCC

	)

217 
	#CFA_WRITE_MULTI_WO_ERASE
 0xCD

	)

218 
	#WIN_GETMEDIASTATUS
 0xDA

	)

219 
	#WIN_ACKMEDIACHANGE
 0xDB

	)

220 
	#WIN_POSTBOOT
 0xDC

	)

221 
	#WIN_PREBOOT
 0xDD

	)

222 
	#WIN_DOORLOCK
 0xDE

	)

223 
	#WIN_DOORUNLOCK
 0xDF

	)

224 
	#WIN_STANDBYNOW1
 0xE0

	)

225 
	#WIN_IDLEIMMEDIATE
 0xE1

	)

226 
	#WIN_STANDBY
 0xE2

	)

227 
	#WIN_SETIDLE1
 0xE3

	)

228 
	#WIN_READ_BUFFER
 0xE4

	)

229 
	#WIN_CHECKPOWERMODE1
 0xE5

	)

230 
	#WIN_SLEEPNOW1
 0xE6

	)

231 
	#WIN_FLUSH_CACHE
 0xE7

	)

232 
	#WIN_WRITE_BUFFER
 0xE8

	)

233 
	#WIN_WRITE_SAME
 0xE9

	)

235 
	#WIN_FLUSH_CACHE_EXT
 0xEA

	)

236 
	#WIN_IDENTIFY
 0xEC

	)

237 
	#WIN_MEDIAEJECT
 0xED

	)

238 
	#WIN_IDENTIFY_DMA
 0xEE

	)

239 
	#WIN_SETFEATURES
 0xEF

	)

240 
	#EXABYTE_ENABLE_NEST
 0xF0

	)

241 
	#WIN_SECURITY_SET_PASS
 0xF1

	)

242 
	#WIN_SECURITY_UNLOCK
 0xF2

	)

243 
	#WIN_SECURITY_ERASE_PREPARE
 0xF3

	)

244 
	#WIN_SECURITY_ERASE_UNIT
 0xF4

	)

245 
	#WIN_SECURITY_FREEZE_LOCK
 0xF5

	)

246 
	#WIN_SECURITY_DISABLE
 0xF6

	)

247 
	#WIN_READ_NATIVE_MAX
 0xF8

	)

248 
	#WIN_SET_MAX
 0xF9

	)

249 
	#DISABLE_SEAGATE
 0xFB

	)

253 
	#SMART_READ_VALUES
 0xD0

	)

254 
	#SMART_READ_THRESHOLDS
 0xD1

	)

255 
	#SMART_AUTOSAVE
 0xD2

	)

256 
	#SMART_SAVE
 0xD3

	)

257 
	#SMART_IMMEDIATE_OFFLINE
 0xD4

	)

258 
	#SMART_READ_LOG_SECTOR
 0xD5

	)

259 
	#SMART_WRITE_LOG_SECTOR
 0xD6

	)

260 
	#SMART_WRITE_THRESHOLDS
 0xD7

	)

261 
	#SMART_ENABLE
 0xD8

	)

262 
	#SMART_DISABLE
 0xD9

	)

263 
	#SMART_STATUS
 0xDA

	)

264 
	#SMART_AUTO_OFFLINE
 0xDB

	)

268 
	#SMART_LCYL_PASS
 0x4F

	)

269 
	#SMART_HCYL_PASS
 0xC2

	)

272 
	#SETFEATURES_EN_8BIT
 0x01

	)

273 
	#SETFEATURES_EN_WCACHE
 0x02

	)

274 
	#SETFEATURES_DIS_DEFECT
 0x04

	)

275 
	#SETFEATURES_EN_APM
 0x05

	)

276 
	#SETFEATURES_EN_SAME_R
 0x22

	)

277 
	#SETFEATURES_DIS_MSN
 0x31

	)

278 
	#SETFEATURES_DIS_RETRY
 0x33

	)

279 
	#SETFEATURES_EN_AAM
 0x42

	)

280 
	#SETFEATURES_RW_LONG
 0x44

	)

281 
	#SETFEATURES_SET_CACHE
 0x54

	)

282 
	#SETFEATURES_DIS_RLA
 0x55

	)

283 
	#SETFEATURES_EN_RI
 0x5D

	)

284 
	#SETFEATURES_EN_SI
 0x5E

	)

285 
	#SETFEATURES_DIS_RPOD
 0x66

	)

286 
	#SETFEATURES_DIS_ECC
 0x77

	)

287 
	#SETFEATURES_DIS_8BIT
 0x81

	)

288 
	#SETFEATURES_DIS_WCACHE
 0x82

	)

289 
	#SETFEATURES_EN_DEFECT
 0x84

	)

290 
	#SETFEATURES_DIS_APM
 0x85

	)

291 
	#SETFEATURES_EN_ECC
 0x88

	)

292 
	#SETFEATURES_EN_MSN
 0x95

	)

293 
	#SETFEATURES_EN_RETRY
 0x99

	)

294 
	#SETFEATURES_EN_RLA
 0xAA

	)

295 
	#SETFEATURES_PREFETCH
 0xAB

	)

296 
	#SETFEATURES_EN_REST
 0xAC

	)

297 
	#SETFEATURES_4B_RW_LONG
 0xBB

	)

298 
	#SETFEATURES_DIS_AAM
 0xC2

	)

299 
	#SETFEATURES_EN_RPOD
 0xCC

	)

300 
	#SETFEATURES_DIS_RI
 0xDD

	)

301 
	#SETFEATURES_EN_SAME_M
 0xDD

	)

302 
	#SETFEATURES_DIS_SI
 0xDE

	)

306 
	#SECURITY_SET_PASSWORD
 0xBA

	)

307 
	#SECURITY_UNLOCK
 0xBB

	)

308 
	#SECURITY_ERASE_PREPARE
 0xBC

	)

309 
	#SECURITY_ERASE_UNIT
 0xBD

	)

310 
	#SECURITY_FREEZE_LOCK
 0xBE

	)

311 
	#SECURITY_DISABLE_PASSWORD
 0xBF

	)

313 
	shd_geom‘ry
 {

314 
	mh—ds
;

315 
	m£ùÜs
;

316 
	mcylšd”s
;

317 
	m¡¬t
;

321 
	#HDIO_GETGEO
 0x0301

	)

322 
	#HDIO_GET_UNMASKINTR
 0x0302

	)

323 
	#HDIO_GET_MULTCOUNT
 0x0304

	)

324 
	#HDIO_GET_QDMA
 0x0305

	)

326 
	#HDIO_SET_XFER
 0x0306

	)

328 
	#HDIO_OBSOLETE_IDENTITY
 0x0307

	)

329 
	#HDIO_GET_KEEPSETTINGS
 0x0308

	)

330 
	#HDIO_GET_32BIT
 0x0309

	)

331 
	#HDIO_GET_NOWERR
 0x030¨

	)

332 
	#HDIO_GET_DMA
 0x030b

	)

333 
	#HDIO_GET_NICE
 0x030ø

	)

334 
	#HDIO_GET_IDENTITY
 0x030d

	)

335 
	#HDIO_GET_WCACHE
 0x030

	)

336 
	#HDIO_GET_ACOUSTIC
 0x030à

	)

337 
	#HDIO_GET_ADDRESS
 0x0310

	)

339 
	#HDIO_GET_BUSSTATE
 0x031¨

	)

340 
	#HDIO_TRISTATE_HWIF
 0x031b

	)

341 
	#HDIO_DRIVE_RESET
 0x031ø

	)

342 
	#HDIO_DRIVE_TASKFILE
 0x031d

	)

343 
	#HDIO_DRIVE_TASK
 0x031

	)

344 
	#HDIO_DRIVE_CMD
 0x031à

	)

345 
	#HDIO_DRIVE_CMD_AEB
 
HDIO_DRIVE_TASK


	)

348 
	#HDIO_SET_MULTCOUNT
 0x0321

	)

349 
	#HDIO_SET_UNMASKINTR
 0x0322

	)

350 
	#HDIO_SET_KEEPSETTINGS
 0x0323

	)

351 
	#HDIO_SET_32BIT
 0x0324

	)

352 
	#HDIO_SET_NOWERR
 0x0325

	)

353 
	#HDIO_SET_DMA
 0x0326

	)

354 
	#HDIO_SET_PIO_MODE
 0x0327

	)

355 
	#HDIO_SCAN_HWIF
 0x0328

	)

356 
	#HDIO_UNREGISTER_HWIF
 0x032¨

	)

357 
	#HDIO_SET_NICE
 0x0329

	)

358 
	#HDIO_SET_WCACHE
 0x032b

	)

359 
	#HDIO_SET_ACOUSTIC
 0x032ø

	)

360 
	#HDIO_SET_BUSSTATE
 0x032d

	)

361 
	#HDIO_SET_QDMA
 0x032

	)

362 
	#HDIO_SET_ADDRESS
 0x032à

	)

366 
	mBUSSTATE_OFF
 = 0,

367 
	mBUSSTATE_ON
,

368 
	mBUSSTATE_TRISTATE


377 
	#__NEW_HD_DRIVE_ID


	)

385 
	shd_driveid
 {

386 
	mcÚfig
;

387 
	mcyls
;

388 
	m»£rved2
;

389 
	mh—ds
;

390 
	mŒack_by‹s
;

391 
	m£ùÜ_by‹s
;

392 
	m£ùÜs
;

393 
	mv’dÜ0
;

394 
	mv’dÜ1
;

395 
	mv’dÜ2
;

396 
	m£rŸl_no
[20];

397 
	mbuf_ty³
;

398 
	mbuf_size
;

401 
	mecc_by‹s
;

402 
	mfw_»v
[8];

403 
	mmod–
[40];

404 
	mmax_muÉ£ù
;

405 
	mv’dÜ3
;

406 
	mdwÜd_io
;

407 
	mv’dÜ4
;

408 
	mÿ·bž™y
;

414 
	m»£rved50
;

415 
	mv’dÜ5
;

416 
	mtPIO
;

417 
	mv’dÜ6
;

418 
	mtDMA
;

419 
	mf›ld_v®id
;

424 
	mcur_cyls
;

425 
	mcur_h—ds
;

426 
	mcur_£ùÜs
;

427 
	mcur_ÿ·c™y0
;

428 
	mcur_ÿ·c™y1
;

429 
	mmuÉ£ù
;

430 
	mmuÉ£ù_v®id
;

431 
	mlba_ÿ·c™y
;

432 
	mdma_1wÜd
;

433 
	mdma_mwÜd
;

434 
	meide_pio_modes
;

435 
	meide_dma_mš
;

436 
	meide_dma_time
;

437 
	meide_pio
;

438 
	meide_pio_iÜdy
;

439 
	mwÜds69_70
[2];

442 
	mwÜds71_74
[4];

445 
	mqueue_d•th
;

449 
	mwÜds76_79
[4];

450 
	mmajÜ_»v_num
;

451 
	mmšÜ_»v_num
;

452 
	mcommªd_£t_1
;

470 
	mcommªd_£t_2
;

488 
	mcfs£
;

500 
	mcfs_’abË_1
;

519 
	mcfs_’abË_2
;

538 
	mcsf_deçuÉ
;

550 
	mdma_uÉ¿
;

551 
	mŒ£uc
;

552 
	mŒsEuc
;

553 
	mCurAPMv®ues
;

554 
	mm´c
;

555 
	mhw_cÚfig
;

573 
	macou¡ic
;

577 
	mm¤qs
;

578 
	msxã¹
;

579 
	m§l
;

580 
	m¥g
;

581 
	mlba_ÿ·c™y_2
;

582 
	mwÜds104_125
[22];

583 
	mÏ¡_lun
;

584 
	mwÜd127
;

592 
	mdlf
;

604 
	mcsfo
;

612 
	mwÜds130_155
[26];

613 
	mwÜd156
;

614 
	mwÜds157_159
[3];

615 
	mcç_pow”
;

622 
	mwÜds161_175
[15];

623 
	mwÜds176_205
[30];

624 
	mwÜds206_254
[49];

625 
	mš‹gr™y_wÜd
;

636 
	#IDE_NICE_DSC_OVERLAP
 (0è

	)

637 
	#IDE_NICE_ATAPI_OVERLAP
 (1è

	)

638 
	#IDE_NICE_1
 (3è

	)

639 
	#IDE_NICE_0
 (2è

	)

640 
	#IDE_NICE_2
 (4è

	)

	@/usr/include/linux/kdev_t.h

1 #iâdeà
_LINUX_KDEV_T_H


2 
	#_LINUX_KDEV_T_H


	)

8 
	#MAJOR
(
dev
è((dev)>>8)

	)

9 
	#MINOR
(
dev
è((devè& 0xff)

	)

10 
	#MKDEV
(
ma
,
mi
è((ma)<<8 | (mi))

	)

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

7 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

8 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

11 
	#SI_LOAD_SHIFT
 16

	)

12 
	ssysšfo
 {

13 
	mu±ime
;

14 
	mlßds
[3];

15 
	mtÙ®¿m
;

16 
	mä“¿m
;

17 
	msh¬ed¿m
;

18 
	mbufã¼am
;

19 
	mtÙ®sw­
;

20 
	mä“sw­
;

21 
	m´ocs
;

22 
	m·d
;

23 
	mtÙ®high
;

24 
	mä“high
;

25 
	mmem_un™
;

26 
	m_f
[20-2*()-()];

29 #ifdeà
__CHECKER__


30 
	#BUILD_BUG_ON_NOT_POWER_OF_2
(
n
)

	)

31 
	#BUILD_BUG_ON_ZERO
(
e
è(0)

	)

32 
	#BUILD_BUG_ON_NULL
(
e
è((*)0)

	)

33 
	#BUILD_BUG_ON
(
cÚd™iÚ
)

	)

37 
	#BUILD_BUG_ON_NOT_POWER_OF_2
(
n
) \

38 
	`BUILD_BUG_ON
((
n
è=ð0 || ((Òè& (Òè- 1)è!ð0))

	)

44 
	#BUILD_BUG_ON_ZERO
(
e
è((¡ruù { :-!!Ó); }))

	)

45 
	#BUILD_BUG_ON_NULL
(
e
è((*)(¡ruù { :-!!Ó); }))

	)

62 #iâdeà
__OPTIMIZE__


63 
	#BUILD_BUG_ON
(
cÚd™iÚ
è(()([1 - 2*!!(cÚd™iÚ)]))

	)

65 
__bužd_bug_Ú_çžed
;

66 
	#BUILD_BUG_ON
(
cÚd™iÚ
) \

68 (()([1 - 2*!!(
cÚd™iÚ
)])); \

69 ià(
cÚd™iÚ
è
__bužd_bug_Ú_çžed
 = 1; \

70 } 0)

	)

75 
	#__FUNCTION__
 (
__func__
)

	)

78 #ifdeà
CONFIG_NUMA


79 
	#NUMA_BUILD
 1

	)

81 
	#NUMA_BUILD
 0

	)

85 #ifdeà
CONFIG_COMPACTION


86 
	#COMPACTION_BUILD
 1

	)

88 
	#COMPACTION_BUILD
 0

	)

92 #ifdeà
CONFIG_FTRACE_MCOUNT_RECORD


93 
	#REBUILD_DUE_TO_FTRACE_MCOUNT_RECORD


	)

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/wait.h

1 #iâdeà
_LINUX_WAIT_H


2 
	#_LINUX_WAIT_H


	)

4 
	#WNOHANG
 0x00000001

	)

5 
	#WUNTRACED
 0x00000002

	)

6 
	#WSTOPPED
 
WUNTRACED


	)

7 
	#WEXITED
 0x00000004

	)

8 
	#WCONTINUED
 0x00000008

	)

9 
	#WNOWAIT
 0x01000000

	)

11 
	#__WNOTHREAD
 0x20000000

	)

12 
	#__WALL
 0x40000000

	)

13 
	#__WCLONE
 0x80000000

	)

16 
	#P_ALL
 0

	)

17 
	#P_PID
 1

	)

18 
	#P_PGID
 2

	)

	@/usr/include/linux/blk_types.h

5 #iâdeà
__LINUX_BLK_TYPES_H


6 
	#__LINUX_BLK_TYPES_H


	)

8 #ifdeà
CONFIG_BLOCK


10 
	~<lšux/ty³s.h
>

12 
	gbio_£t
;

13 
	gbio
;

14 
	gbio_š‹gr™y_·ylßd
;

15 
	g·ge
;

16 
	gblock_deviû
;

17 (
	tbio_’d_io_t
è(
	tbio
 *, );

18 (
	tbio_de¡ruùÜ_t
è(
	tbio
 *);

23 
	sbio_vec
 {

24 
·ge
 *
bv_·ge
;

25 
bv_Ën
;

26 
bv_off£t
;

33 
	sbio
 {

34 
£ùÜ_t
 
bi_£ùÜ
;

36 
bio
 *
bi_Ãxt
;

37 
block_deviû
 *
bi_bdev
;

38 
bi_æags
;

39 
bi_rw
;

43 
bi_vút
;

44 
bi_idx
;

49 
bi_phys_£gm’ts
;

51 
bi_size
;

57 
bi_£g_äÚt_size
;

58 
bi_£g_back_size
;

60 
bi_max_vecs
;

62 
bi_comp_ýu
;

64 
©omic_t
 
bi_út
;

66 
bio_vec
 *
bi_io_vec
;

68 
bio_’d_io_t
 *
bi_’d_io
;

70 *
bi_´iv©e
;

71 #ià
	`defšed
(
CONFIG_BLK_DEV_INTEGRITY
)

72 
bio_š‹gr™y_·ylßd
 *
bi_š‹gr™y
;

75 
bio_de¡ruùÜ_t
 *
bi_de¡ruùÜ
;

82 
bio_vec
 
bi_šlše_vecs
[0];

88 
	#BIO_UPTODATE
 0

	)

89 
	#BIO_RW_BLOCK
 1

	)

90 
	#BIO_EOF
 2

	)

91 
	#BIO_SEG_VALID
 3

	)

92 
	#BIO_CLONED
 4

	)

93 
	#BIO_BOUNCED
 5

	)

94 
	#BIO_USER_MAPPED
 6

	)

95 
	#BIO_EOPNOTSUPP
 7

	)

96 
	#BIO_CPU_AFFINE
 8

	)

97 
	#BIO_NULL_MAPPED
 9

	)

98 
	#BIO_FS_INTEGRITY
 10

	)

99 
	#BIO_QUIET
 11

	)

100 
	#BIO_MAPPED_INTEGRITY
 12

	)

101 
	#bio_æagged
(
bio
, 
æag
è((bio)->
bi_æags
 & (1 << (æag)))

	)

106 
	#BIO_POOL_BITS
 (4)

	)

107 
	#BIO_POOL_NONE
 ((1UL << 
BIO_POOL_BITS
è- 1)

	)

108 
	#BIO_POOL_OFFSET
 (
BITS_PER_LONG
 - 
BIO_POOL_BITS
)

	)

109 
	#BIO_POOL_MASK
 (1UL << 
BIO_POOL_OFFSET
)

	)

110 
	#BIO_POOL_IDX
(
bio
è((bio)->
bi_æags
 >> 
BIO_POOL_OFFSET
)

	)

118 
	erq_æag_b™s
 {

120 
__REQ_WRITE
,

121 
__REQ_FAILFAST_DEV
,

122 
__REQ_FAILFAST_TRANSPORT
,

123 
__REQ_FAILFAST_DRIVER
,

125 
__REQ_SYNC
,

126 
__REQ_META
,

127 
__REQ_DISCARD
,

128 
__REQ_NOIDLE
,

131 
__REQ_RAHEAD
,

132 
__REQ_THROTTLED
,

136 
__REQ_SORTED
,

137 
__REQ_SOFTBARRIER
,

138 
__REQ_FUA
,

139 
__REQ_NOMERGE
,

140 
__REQ_STARTED
,

141 
__REQ_DONTPREP
,

142 
__REQ_QUEUED
,

143 
__REQ_ELVPRIV
,

144 
__REQ_FAILED
,

145 
__REQ_QUIET
,

146 
__REQ_PREEMPT
,

147 
__REQ_ALLOCED
,

148 
__REQ_COPY_USER
,

149 
__REQ_FLUSH
,

150 
__REQ_FLUSH_SEQ
,

151 
__REQ_IO_STAT
,

152 
__REQ_MIXED_MERGE
,

153 
__REQ_SECURE
,

154 
__REQ_NR_BITS
,

157 
	#REQ_WRITE
 (1 << 
__REQ_WRITE
)

	)

158 
	#REQ_FAILFAST_DEV
 (1 << 
__REQ_FAILFAST_DEV
)

	)

159 
	#REQ_FAILFAST_TRANSPORT
 (1 << 
__REQ_FAILFAST_TRANSPORT
)

	)

160 
	#REQ_FAILFAST_DRIVER
 (1 << 
__REQ_FAILFAST_DRIVER
)

	)

161 
	#REQ_SYNC
 (1 << 
__REQ_SYNC
)

	)

162 
	#REQ_META
 (1 << 
__REQ_META
)

	)

163 
	#REQ_DISCARD
 (1 << 
__REQ_DISCARD
)

	)

164 
	#REQ_NOIDLE
 (1 << 
__REQ_NOIDLE
)

	)

166 
	#REQ_FAILFAST_MASK
 \

167 (
REQ_FAILFAST_DEV
 | 
REQ_FAILFAST_TRANSPORT
 | 
REQ_FAILFAST_DRIVER
)

	)

168 
	#REQ_COMMON_MASK
 \

169 (
REQ_WRITE
 | 
REQ_FAILFAST_MASK
 | 
REQ_SYNC
 | 
REQ_META
 | 
REQ_DISCARD
 | \

170 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
 | 
REQ_SECURE
)

	)

171 
	#REQ_CLONE_MASK
 
REQ_COMMON_MASK


	)

173 
	#REQ_RAHEAD
 (1 << 
__REQ_RAHEAD
)

	)

174 
	#REQ_THROTTLED
 (1 << 
__REQ_THROTTLED
)

	)

176 
	#REQ_SORTED
 (1 << 
__REQ_SORTED
)

	)

177 
	#REQ_SOFTBARRIER
 (1 << 
__REQ_SOFTBARRIER
)

	)

178 
	#REQ_FUA
 (1 << 
__REQ_FUA
)

	)

179 
	#REQ_NOMERGE
 (1 << 
__REQ_NOMERGE
)

	)

180 
	#REQ_STARTED
 (1 << 
__REQ_STARTED
)

	)

181 
	#REQ_DONTPREP
 (1 << 
__REQ_DONTPREP
)

	)

182 
	#REQ_QUEUED
 (1 << 
__REQ_QUEUED
)

	)

183 
	#REQ_ELVPRIV
 (1 << 
__REQ_ELVPRIV
)

	)

184 
	#REQ_FAILED
 (1 << 
__REQ_FAILED
)

	)

185 
	#REQ_QUIET
 (1 << 
__REQ_QUIET
)

	)

186 
	#REQ_PREEMPT
 (1 << 
__REQ_PREEMPT
)

	)

187 
	#REQ_ALLOCED
 (1 << 
__REQ_ALLOCED
)

	)

188 
	#REQ_COPY_USER
 (1 << 
__REQ_COPY_USER
)

	)

189 
	#REQ_FLUSH
 (1 << 
__REQ_FLUSH
)

	)

190 
	#REQ_FLUSH_SEQ
 (1 << 
__REQ_FLUSH_SEQ
)

	)

191 
	#REQ_IO_STAT
 (1 << 
__REQ_IO_STAT
)

	)

192 
	#REQ_MIXED_MERGE
 (1 << 
__REQ_MIXED_MERGE
)

	)

193 
	#REQ_SECURE
 (1 << 
__REQ_SECURE
)

	)

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #undeà
NULL


7 #ià
defšed
(
__ýlu¥lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@
1
.
1
/usr/include
23
454
dev-args.h
module.mod.c
pp_narg.h
test.c
xcache-dev.c
xcache-dev.h
xlg-dev.c
xlg-dev.h
xlg_assert.h
xph-dev.c
xph-dev.h
/usr/include/linux/errno.h
/usr/include/linux/fs.h
/usr/include/linux/hdreg.h
/usr/include/linux/kdev_t.h
/usr/include/linux/kernel.h
/usr/include/linux/types.h
/usr/include/linux/wait.h
/usr/include/linux/blk_types.h
/usr/include/linux/ioctl.h
/usr/include/linux/limits.h
/usr/include/linux/posix_types.h
/usr/include/linux/stddef.h
